<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Edit Invoice | RemindFlow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Styles -->
    <link rel="stylesheet" href="/css/add-invoice.css" />
  </head>
  <body>
    <div class="container">
      <button class="back-btn" onclick="history.back()">← Back</button>

      <h2>Edit Invoice</h2>

      <!-- Invoice ID (Optional) -->
      <label>Invoice ID (optional)</label>
      <input type="text" id="invoiceIdInput" placeholder="INV-XXXX" />

      <!-- Client Selection -->
      <label>Client *</label>
      <div class="client-select">
        <input
          type="text"
          id="clientSearch"
          placeholder="Search or select client"
          autocomplete="off"
          required
        />

        <button
          id="changeClientBtn"
          type="button"
          class="change-client-btn"
          style="display: none"
        >
          Change
        </button>

        <button
          class="add-client-btn"
          type="button"
          onclick="location.href='/add-client.html'"
        >
          + Add Client
        </button>
      </div>

      <ul id="clientDropdown" class="dropdown"></ul>

      <!-- Invoice Meta -->
      <div class="row">
        <div>
          <label>Invoice Date *</label>
          <input type="date" id="invoiceDate" required />
        </div>
        <div>
          <label>Due Date *</label>
          <input type="date" id="dueDate" required />
        </div>
      </div>

      <!-- Line Items -->
      <h3>Invoice Items</h3>

      <!-- ✅ FIXED STRUCTURE -->
      <div class="invoice-items-grid header">
        <div>Description</div>
        <div>Qty</div>
        <div>Rate</div>
        <div></div>
      </div>

      <div id="itemsContainer"></div>

      <button
        type="button"
        id="addItemBtn"
        class="secondary-btn add-item-btn"
      >
        + Add Item
      </button>

      <!-- Tax -->
      <h3>Tax (optional)</h3>
      <div class="row">
        <input id="taxName" placeholder="Tax name (e.g. GST)" />
        <input id="taxRate" type="number" placeholder="Rate (%)" />
      </div>

      <!-- Discount -->
      <label>Discount (optional)</label>
      <input type="number" id="discount" step="0.01" placeholder="₹ 0.00" />

      <!-- Payment Options -->
      <h3>Payment Options</h3>
      <label class="checkbox-row">
        <input type="checkbox" id="enableRazorpay" />
        Enable online payment via Razorpay
      </label>

      <!-- Template -->
      <label>Invoice Template *</label>
      <select id="layoutSelect" required>
        <option value="">Select template</option>
        <option value="minimal">Minimal</option>
        <option value="professional">Professional</option>
        <option value="modern">Modern</option>
      </select>

      <!-- Notes -->
      <label>Notes (optional)</label>
      <textarea id="notes"></textarea>

      <button class="primary-btn" id="saveBtn">
        Save & Preview →
      </button>
    </div>

    <!-- Auth Guard -->
    <script type="module">
      import { requireAuth } from "/js/guard.js";
      requireAuth();
    </script>

    <!-- Page Logic -->
    <script type="module" src="/js/invoice-edit.js"></script>
  </body>
</html>
