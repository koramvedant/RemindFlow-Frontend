<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Add Invoice | RemindFlow</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Styles -->
    <link rel="stylesheet" href="/css/add-invoice.css" />
  </head>
  <body>
    <div class="container">
      <button class="back-btn" onclick="history.back()">← Back</button>

      <h2>Create Invoice</h2>

      <!-- Invoice ID (Optional) -->
      <label>Invoice ID (optional)</label>
      <input
        type="text"
        id="invoiceIdInput"
        placeholder="INV-XXXX"
      />

      <!-- Client Selection -->
      <label>Client *</label>
      <div class="client-select">
        <input
          type="text"
          id="clientSearch"
          placeholder="Search or select client"
          autocomplete="off"
          required
        />

        <button
          id="changeClientBtn"
          type="button"
          class="change-client-btn"
          style="display: none"
        >
          Change
        </button>

        <button
          class="add-client-btn"
          type="button"
          onclick="location.href='/add-client.html'"
        >
          + Add Client
        </button>
      </div>

      <ul id="clientDropdown" class="dropdown"></ul>

      <!-- Invoice Meta -->
      <div class="row">
        <div>
          <label>Invoice Date *</label>
          <input type="date" id="invoiceDate" required />
        </div>
        <div>
          <label>Due Date *</label>
          <input type="date" id="dueDate" required />
        </div>
      </div>

      <!-- Line Items -->
      <h3>Invoice Items</h3>

      <table class="items-table">
        <thead>
          <tr>
            <th>Description</th>
            <th width="100">Qty</th>
            <th width="120">Rate</th>
          </tr>
        </thead>
        <tbody id="itemsBody">
          <tr class="item-row">
            <td>
              <input class="item-desc" placeholder="Service or product" />
            </td>
            <td>
              <input class="item-qty" type="number" min="1" value="1" />
            </td>
            <td>
              <input class="item-rate" type="number" step="0.01" />
            </td>
          </tr>
        </tbody>
      </table>

      <button type="button" class="secondary-btn" id="addItemBtn">
        + Add Item
      </button>

      <!-- Tax -->
      <h3>Tax (optional)</h3>
      <div class="row">
        <input id="taxName" placeholder="Tax name (e.g. GST)" />
        <input id="taxRate" type="number" placeholder="Rate (%)" />
      </div>

      <!-- Discount -->
      <label>Discount (optional)</label>
      <input type="number" id="discount" step="0.01" placeholder="₹ 0.00" />

      <!-- Payment Options -->
      <h3>Payment Options</h3>
      <label class="checkbox-row">
        <input type="checkbox" id="enableRazorpay" />
        Enable online payment via Razorpay
      </label>

      <!-- Template -->
      <label>Invoice Template *</label>
      <select id="layoutSelect" required>
        <option value="">Select template</option>
        <option value="minimal">Minimal</option>
        <option value="professional">Professional</option>
        <option value="modern">Modern</option>
      </select>

      <!-- Notes -->
      <label>Notes (optional)</label>
      <textarea id="notes"></textarea>

      <button class="primary-btn" id="continueBtn">
        Continue → Preview
      </button>
    </div>

    <!-- Auth Guard -->
    <script type="module">
      import { requireAuth } from "/js/guard.js";
      requireAuth();
    </script>

    <!-- Page Logic -->
    <script type="module" src="/js/add-invoice.js"></script>

    <script>
      document.getElementById("addItemBtn").onclick = () => {
        const row = document.createElement("tr");
        row.className = "item-row";
        row.innerHTML = `
          <td><input class="item-desc" /></td>
          <td><input class="item-qty" type="number" min="1" value="1" /></td>
          <td><input class="item-rate" type="number" step="0.01" /></td>
        `;
        document.getElementById("itemsBody").appendChild(row);
      };
    </script>
  </body>
</html>
