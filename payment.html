<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Payment – RemindFlow</title>
  <link rel="stylesheet" href="/css/payment.css" />
</head>
<body>
  <main class="container">
    <h1>Upgrade Your Plan</h1>

    <p>
      Plan: <strong id="planDisplay">Loading...</strong><br />
      Amount to pay: <strong>₹<span id="amountDisplay">0</span></strong>
    </p>

    <button id="payBtn" class="primary-btn">Pay Now</button>
  </main>

  <!-- Razorpay Checkout -->
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <!-- Backend-injected variables -->
  <script>
    // User info
    window.USER_TYPE = "<%= user.plan_type %>";       // 'full' or 'integrated'
    window.USER_EMAIL = "<%= user.email %>";
    window.USER_PHONE = "<%= user.phone %>";
    window.RAZORPAY_KEY_ID = "<%= razorpay_key_id %>"; // Public key
    window.PLAN_CODE = "<%= user.plan_code || 'starter' %>"; // starter/growth/pro/connector

    // Set JWT cookie for frontend access
    (function() {
      const token = "<%= auth_token %>";
      if (token) {
        const expires = new Date(Date.now() + 7*24*60*60*1000).toUTCString();
        document.cookie = `accessToken=${token}; path=/; expires=${expires}; secure; samesite=strict`;
        window.TOKEN = token; // backward compatibility
      }
    })();
  </script>

  <!-- JS module -->
  <script type="module" src="/js/payment.js"></script>
</body>
</html>
